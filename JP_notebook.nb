(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    141942,       3910]
NotebookOptionsPosition[    135098,       3784]
NotebookOutlinePosition[    135485,       3800]
CellTagsIndexPosition[    135442,       3797]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pauli Helper Functions", "Section",
 CellChangeTimes->{{3.873410335856886*^9, 
  3.87341033847313*^9}},ExpressionUUID->"c8048c5d-c1a0-4e37-b919-\
7465432404cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PauliTuples", "[", "n_", "]"}], ":=", 
  RowBox[{"Tuples", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "n"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PauliTuples", "[", "1", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "3"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatList", "[", "pList_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"PauliMatrix", ",", "pList"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PauliGroup", "[", "n_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"MatList", ",", 
    RowBox[{"PauliTuples", "[", "n", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatForm", "[", "matList_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "matList", "]"}], ">", "4"}], ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"KroneckerProduct", ",", "matList"}], "]"}], ",", "matList"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrToMat", "[", "pList_", "]"}], ":=", " ", 
  RowBox[{"MatForm", "[", 
   RowBox[{"MatList", "[", "pList", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dilate", "[", "mat_", "]"}], ":=", " ", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"ConjugateTranspose", "[", "mat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mat", ",", "0"}], "}"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPauliRepr", "[", 
   RowBox[{"mat_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["2", "n"]], 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"StrToMat", "[", "pauli", "]"}], ".", "mat"}], "]"}]}], 
        ",", "pauli"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pauli", ",", 
        RowBox[{"PauliTuples", "[", "n", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "__"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPauliRepr", "[", 
   RowBox[{"mat_", ",", "1"}], "]"}], ":=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Tr", "[", 
          RowBox[{
           RowBox[{"PauliMatrix", "[", "pauli", "]"}], ".", "mat"}], "]"}]}], 
        ",", "pauli"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pauli", ",", 
        RowBox[{"PauliTuples", "[", "1", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "__"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PauliListToMat", "[", "list_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"list", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], 
     RowBox[{"StrToMat", "[", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PauliExp", "[", 
   RowBox[{"nVec_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"MatrixExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"nVec", ".", 
       RowBox[{"MatList", "[", 
        RowBox[{"PauliTuples", "[", "1", "]"}], "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    FractionBox["\[Theta]", "2"]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8734103418964157`*^9, 3.873410342439065*^9}, {
   3.873410387508713*^9, 3.8734105713025208`*^9}, {3.87341064941308*^9, 
   3.873410676577422*^9}, {3.873410720737062*^9, 3.873410721240288*^9}, {
   3.8734108129707117`*^9, 3.8734108324070807`*^9}, {3.873410887875149*^9, 
   3.873410907432632*^9}, {3.873410956204823*^9, 3.8734109693880997`*^9}, {
   3.87341102949476*^9, 3.873411204124054*^9}, {3.8734112729193983`*^9, 
   3.873411276127466*^9}, {3.87341134436236*^9, 3.873411383210984*^9}, {
   3.873411452665317*^9, 3.8734114531204157`*^9}, {3.8734115807604628`*^9, 
   3.873411616746461*^9}, {3.8734116862528267`*^9, 3.8734117118844233`*^9}, {
   3.8734118057500563`*^9, 3.8734119343113947`*^9}, {3.8734119791268387`*^9, 
   3.8734120159586897`*^9}, {3.873412053856475*^9, 3.87341205781756*^9}, {
   3.873412175339876*^9, 3.873412183579462*^9}, {3.8734123413199778`*^9, 
   3.8734123843913*^9}, {3.873412419189369*^9, 3.873412440192852*^9}, {
   3.873412478209392*^9, 3.873412479244824*^9}, {3.873412774874563*^9, 
   3.873412786161075*^9}, {3.873413021366392*^9, 3.8734130287685013`*^9}, 
   3.8734138884903727`*^9, {3.873424377798449*^9, 3.8734244056237917`*^9}, 
   3.873424689697562*^9, {3.8734248276516113`*^9, 3.8734248943368587`*^9}, {
   3.8734250948700933`*^9, 3.873425133218008*^9}, {3.873425165439768*^9, 
   3.873425387629902*^9}, {3.8735652302292757`*^9, 3.873565239526812*^9}, {
   3.873565378176689*^9, 3.873565379064024*^9}, {3.873566004040818*^9, 
   3.8735660130350933`*^9}, {3.873566082963825*^9, 3.8735660999069653`*^9}, {
   3.8735661304246683`*^9, 3.87356613192206*^9}, {3.873566198084238*^9, 
   3.873566198798451*^9}, {3.873566533391884*^9, 3.8735665356576138`*^9}, 
   3.8735666375297832`*^9, {3.87356768901019*^9, 3.8735676912030582`*^9}, 
   3.873567743109272*^9, {3.8735680437434893`*^9, 3.8735680603754272`*^9}, {
   3.873568156807457*^9, 3.873568171727035*^9}, {3.873568205727213*^9, 
   3.873568251258938*^9}, {3.873568703980665*^9, 3.873568723058156*^9}, {
   3.873568781516683*^9, 3.8735687839916286`*^9}, 3.8735689267320137`*^9, {
   3.873568958176383*^9, 3.873569010514859*^9}, {3.873569183640081*^9, 
   3.873569198425561*^9}, 3.873570209949152*^9, 3.874525403523943*^9, {
   3.875127091899139*^9, 3.8751270951741877`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"0b3fd763-2d43-455e-86ae-f36af1e1e56e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error Map Helpers", "Section",
 CellChangeTimes->{{3.87357019157264*^9, 
  3.8735701975385447`*^9}},ExpressionUUID->"06d0dfdb-889e-4d5e-937d-\
642bc51d30b5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"x", ",", "FMat"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DensityToPTVec", "[", 
   RowBox[{"\[Rho]_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         SuperscriptBox["2", "n"]]], 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"PauliMatrix", "[", "pauli", "]"}], ".", "\[Rho]"}], "]"}]}],
       ",", "pauli"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"pauli", ",", 
      RowBox[{"PauliTuples", "[", "n", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DensityToPTVec", "[", 
   RowBox[{"\[Rho]_", ",", 
    RowBox[{"1", "_"}]}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "pauli", "]"}], ".", "\[Rho]"}], "]"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"pauli", ",", 
      RowBox[{"PauliTuples", "[", "1", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OpToPTM", "[", 
   RowBox[{"op_", ",", 
    RowBox[{"1", "_"}]}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PauliMatrix", "[", "P1", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ".", 
       RowBox[{"op", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "P2", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ".", 
       RowBox[{"ConjugateTranspose", "[", 
        RowBox[{"op", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"P1", ",", 
      RowBox[{"PauliTuples", "[", "1", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"P2", ",", 
      RowBox[{"PauliTuples", "[", "1", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FMat", "[", "x_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}], "]"}], ",", " ", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"x", ",", "12"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zeros", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FUnit", "[", "i_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}], "]"}], ",", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "i", "}"}], "->", "1"}], ",", "12"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.873570215673646*^9, 3.873570333109366*^9}, {
   3.873570415917111*^9, 3.8735704218450613`*^9}, {3.873570479392078*^9, 
   3.873570621672702*^9}, {3.873570814317533*^9, 3.8735709434694767`*^9}, {
   3.873574990530064*^9, 3.873575121545298*^9}, {3.873601404261821*^9, 
   3.873601449904583*^9}, {3.873601482341172*^9, 3.873601565959732*^9}, {
   3.87360161172845*^9, 3.8736016329785433`*^9}, {3.87360167889155*^9, 
   3.873601681789061*^9}, {3.87360171270839*^9, 3.873601768580317*^9}, {
   3.873601834920764*^9, 3.8736018446994877`*^9}, {3.873601881562117*^9, 
   3.873601901343322*^9}, 3.8736034937921467`*^9, {3.873603583486761*^9, 
   3.8736035840294943`*^9}, {3.873603688713457*^9, 3.8736037457564774`*^9}, {
   3.873603796831458*^9, 3.8736038507580967`*^9}, {3.87425329462568*^9, 
   3.874253327762833*^9}, {3.874253372330432*^9, 3.8742534449485207`*^9}, {
   3.874253792239354*^9, 3.874253837279739*^9}, {3.874255093582242*^9, 
   3.874255105026873*^9}, {3.874255215114951*^9, 3.8742552371369247`*^9}, {
   3.874255276491673*^9, 3.874255358936551*^9}, {3.8742560548916817`*^9, 
   3.87425605836506*^9}, {3.874256240240245*^9, 3.874256248105011*^9}, {
   3.874525379927108*^9, 3.8745253802566013`*^9}, {3.8746049112259207`*^9, 
   3.874604911390366*^9}, {3.874605068948153*^9, 3.8746051079709063`*^9}, {
   3.874607339169146*^9, 3.874607477509946*^9}, {3.87512636731925*^9, 
   3.875126397164646*^9}, 3.875126814867222*^9, {3.875126879350545*^9, 
   3.875126881362211*^9}, {3.8751269294430647`*^9, 3.875126962232093*^9}, {
   3.875209142544158*^9, 
   3.875209161525818*^9}},ExpressionUUID->"e8a42345-a61c-426a-9d13-\
c6bf73ae057b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.874605076435972*^9, 3.874605108324642*^9}, {
   3.874607345398677*^9, 3.874607363388742*^9}, {3.8746074014064217`*^9, 
   3.874607477967887*^9}, 3.875126069110783*^9, {3.87512639130077*^9, 
   3.875126397533264*^9}, 3.87512681702439*^9, 3.875126882052044*^9, {
   3.875126934238949*^9, 3.875126962790979*^9}, {3.8752091441121597`*^9, 
   3.8752091524270077`*^9}},
 CellLabel->
  "Out[257]//MatrixForm=",ExpressionUUID->"1254d911-7a1c-491e-98bb-\
a5566bc692a8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "\[ExponentialE]", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.874605076435972*^9, 3.874605108324642*^9}, {
   3.874607345398677*^9, 3.874607363388742*^9}, {3.8746074014064217`*^9, 
   3.874607477967887*^9}, 3.875126069110783*^9, {3.87512639130077*^9, 
   3.875126397533264*^9}, 3.87512681702439*^9, 3.875126882052044*^9, {
   3.875126934238949*^9, 3.875126962790979*^9}, {3.8752091441121597`*^9, 
   3.875209152435622*^9}},
 CellLabel->
  "Out[258]//MatrixForm=",ExpressionUUID->"33afd04b-ee61-44dd-815a-\
55e013dd540a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3", "[", "1", "]"}], ",", 
     RowBox[{"3", "[", "2", "]"}], ",", 
     RowBox[{"3", "[", "3", "]"}], ",", 
     RowBox[{"3", "[", "4", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3", "[", "5", "]"}], ",", 
     RowBox[{"3", "[", "6", "]"}], ",", 
     RowBox[{"3", "[", "7", "]"}], ",", 
     RowBox[{"3", "[", "8", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3", "[", "9", "]"}], ",", 
     RowBox[{"3", "[", "10", "]"}], ",", 
     RowBox[{"3", "[", "11", "]"}], ",", 
     RowBox[{"3", "[", "12", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.874605076435972*^9, 3.874605108324642*^9}, {
   3.874607345398677*^9, 3.874607363388742*^9}, {3.8746074014064217`*^9, 
   3.874607477967887*^9}, 3.875126069110783*^9, {3.87512639130077*^9, 
   3.875126397533264*^9}, 3.87512681702439*^9, 3.875126882052044*^9, {
   3.875126934238949*^9, 3.875126962790979*^9}, {3.8752091441121597`*^9, 
   3.8752091524455013`*^9}},
 CellLabel->
  "Out[259]=",ExpressionUUID->"558f73b7-9d2c-4984-a619-6a2946f87c2e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sorting Functions and GST strings", "Section",
 CellChangeTimes->{
  3.87356625139141*^9, 3.874256339044208*^9, {3.874263452765482*^9, 
   3.874263473673229*^9}, {3.874263594622856*^9, 3.8742635970564957`*^9}, {
   3.875209285456044*^9, 
   3.875209286139558*^9}},ExpressionUUID->"22a70cee-fa43-4288-bcb1-\
6178c2273a9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Exp2", "[", "mat_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{
     RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", "mat", " ", "+", 
   " ", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"MatrixPower", "[", 
     RowBox[{"mat", ",", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.875211038120014*^9, 3.875211047675377*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"f84eafaa-2273-4382-ae20-f92bab833e23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lFun", "[", "idx_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"idx", " ", "==", " ", "1"}], ",", "0", ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"idx", " ", "==", " ", "3"}], ",", " ", "1", ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lFun", "[", 
          RowBox[{"idx", "-", "1"}], "]"}], "+", "1"}], ",", "2"}], "]"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgstBitString", "[", "N_", "]"}], ":=", 
  RowBox[{"Array", "[", 
   RowBox[{"lFun", ",", "N"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SwapLeftTree", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"trimList", " ", "=", " ", 
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"SwapList", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"inter", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"trimList", " ", "!=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"trimList", ",", "Greater"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "<", 
            RowBox[{"Length", "[", "trimList", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"trimList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"trimList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "==", "1"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"inter", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"inter", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "+", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"trimList", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "+", "1"}]}], "}"}], "]"}], "]"}], "=", 
               RowBox[{"trimList", "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "]"}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
             "Nothing"}], " ", "]"}]}], " ", "]"}], ";", " ", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"SwapList", ",", " ", "inter"}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
         RowBox[{"inter", " ", "=", " ", 
          RowBox[{"{", "}"}]}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t\t", 
      RowBox[{"Return", "[", "SwapList", " ", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Please", " ", "give", " ", "error", " ", "maps", " ", "as", " ", "a", 
      " ", "list", " ", "of", " ", "to"}], "-", "be", "-", 
     RowBox[{"exponentiated", " ", "matrices"}]}], ",", " ", 
    RowBox[{
    "then", " ", "I", " ", "can", " ", "keep", " ", "track", " ", "of", " ", 
     "which", " ", "matrices", " ", "are", " ", "\"\<exponentiated\>\"", " ", 
     "myself"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LCommSwap", "[", 
    RowBox[{"lhsMat_", ",", "expMat_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"lhsMat", ".", "expMat", ".", 
      RowBox[{"Inverse", "[", "lhsMat", "]"}]}], ",", "lhsMat"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplySwaps", "[", 
   RowBox[{"swapTree_", ",", "bitList_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"interior", "=", " ", 
      RowBox[{"bitList", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"idx", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"idx", " ", "<=", " ", 
        RowBox[{"Length", "[", "swapTree", "]"}]}], ",", 
       RowBox[{"idx", " ", "++"}], ",", " ", "\[IndentingNewLine]", 
       "\t\t\t\t\t\t\t\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"jdx", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"jdx", " ", "<=", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"swapTree", "[", 
            RowBox[{"[", "idx", "]"}], "]"}], "]"}]}], ",", " ", 
         RowBox[{"jdx", "++"}], ",", "\[IndentingNewLine]", 
         "\t\t\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"interior", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"swapTree", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "[", 
             RowBox[{"[", "jdx", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"interior", "[", 
           RowBox[{"[", 
            RowBox[{"Reverse", "[", 
             RowBox[{
              RowBox[{"swapTree", "[", 
               RowBox[{"[", "idx", "]"}], "]"}], "[", 
              RowBox[{"[", "jdx", "]"}], "]"}], "]"}], "]"}], "]"}]}]}], 
        "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
     RowBox[{"Return", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bitList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "interior", ",", 
        RowBox[{"{", 
         RowBox[{"bitList", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortBitList", "[", "bitList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"swapTree", " ", "=", " ", 
      RowBox[{"SwapLeftTree", "[", "bitList", "]"}]}], "}"}], ",", 
    RowBox[{"ApplySwaps", "[", 
     RowBox[{"swapTree", ",", "bitList"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SortLGSTArray", "[", "gateSet_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"swaps", " ", "=", " ", 
       RowBox[{"SwapLeftTree", "[", 
        RowBox[{"lgstBitString", "[", 
         RowBox[{"Length", "[", "gateSet", "]"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"inside", " ", "=", " ", 
       RowBox[{"gateSet", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"idx", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"idx", " ", "<=", " ", 
        RowBox[{"Length", "[", "swaps", "]"}]}], ",", 
       RowBox[{"idx", " ", "++"}], ",", " ", "\[IndentingNewLine]", 
       "\t\t\t\t\t\t\t\t", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jdx", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"jdx", "<=", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"swaps", "[", 
             RowBox[{"[", "idx", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"jdx", " ", "++"}], ",", "\[IndentingNewLine]", 
          "\t\t\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"inside", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"swaps", "[", 
                RowBox[{"[", "idx", "]"}], "]"}], "[", 
               RowBox[{"[", "jdx", "]"}], "]"}], "]"}], "]"}], "=", " ", 
            RowBox[{"LCommSwap", "[", 
             RowBox[{
              RowBox[{"inside", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"swaps", "[", 
                   RowBox[{"[", "idx", "]"}], "]"}], "[", 
                  RowBox[{"[", "jdx", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}], ",", 
              RowBox[{"inside", "[", 
               RowBox[{"[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"swaps", "[", 
                   RowBox[{"[", "idx", "]"}], "]"}], "[", 
                  RowBox[{"[", "jdx", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}]}], "]"}]}],
            ";"}]}], "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", "]"}], 
        ";"}]}], "   ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t ", "]"}], ";", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t ", 
     RowBox[{"Return", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"gateSet", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "inside", ",", " ", 
        RowBox[{"{", 
         RowBox[{"gateSet", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}], "]"}], " ", 
     ";"}]}], "\[IndentingNewLine]", "\t\t\t\t\t\t", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftForm", "[", 
    RowBox[{"gateList_", ",", "errList_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"idx", "=", "1"}], ",", 
       RowBox[{"jdx", " ", "=", " ", "1"}], ",", 
       RowBox[{"bs", " ", "=", " ", 
        RowBox[{"lgstBitString", "[", 
         RowBox[{"2", "*", 
          RowBox[{"Length", "[", "gateList", "]"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bs", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "==", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"idx", "+=", " ", "1"}], ";", " ", 
          RowBox[{"errList", "[", 
           RowBox[{"[", 
            RowBox[{"idx", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"jdx", "+=", "1"}], ";", " ", 
          RowBox[{"gateList", "[", 
           RowBox[{"[", 
            RowBox[{"jdx", "-", "1"}], "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"2", "*", 
          RowBox[{"Length", "[", "gateList", "]"}]}]}], "}"}]}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpGSTGates", "[", "gateSet_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"idx", "=", "1"}], ",", 
      RowBox[{"bits", " ", "=", " ", 
       RowBox[{
        RowBox[{"lgstBitString", "[", 
         RowBox[{"Length", "[", "gateSet", "]"}], "]"}], "//", 
        "SortBitList"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bits", "[", 
          RowBox[{"[", "idx", "]"}], "]"}], "==", "1"}], ",", 
        RowBox[{"Exp2", "[", 
         RowBox[{"gateSet", "[", 
          RowBox[{"[", "idx", "]"}], "]"}], "]"}], ",", 
        RowBox[{"gateSet", "[", 
         RowBox[{"[", "idx", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"idx", ",", "1", ",", 
        RowBox[{"Length", "[", "bits", "]"}]}], "}"}]}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.873425417044437*^9, 3.873425448514213*^9}, 
   3.8734256745489683`*^9, {3.8735553108054028`*^9, 3.8735553254717503`*^9}, {
   3.8735553960231047`*^9, 3.873555433318995*^9}, {3.873555552544002*^9, 
   3.873555575954225*^9}, {3.873556182366769*^9, 3.8735562548585987`*^9}, {
   3.873556482013527*^9, 3.873556483209859*^9}, {3.87355654591072*^9, 
   3.873556683429739*^9}, {3.8735573749094276`*^9, 3.873557385493531*^9}, {
   3.873604195297596*^9, 3.8736042045141973`*^9}, {3.874256836171712*^9, 
   3.874256898475296*^9}, {3.874256940522788*^9, 3.874256942491232*^9}, {
   3.874256999305974*^9, 3.874257005560617*^9}, {3.874257043336237*^9, 
   3.8742572495361547`*^9}, {3.8742573105810432`*^9, 3.874257311130494*^9}, {
   3.874257346800828*^9, 3.8742573728275013`*^9}, {3.874257412263711*^9, 
   3.874257429670773*^9}, {3.8742575282632103`*^9, 3.874257533838256*^9}, {
   3.874257568361953*^9, 3.874257588386857*^9}, {3.874257621516995*^9, 
   3.8742576777051153`*^9}, {3.87425773676331*^9, 3.874257760488256*^9}, {
   3.874257946691593*^9, 3.8742579563566027`*^9}, {3.8742580078957653`*^9, 
   3.8742580191449547`*^9}, {3.874258107337146*^9, 3.874258185327282*^9}, {
   3.874258407526024*^9, 3.874258436949089*^9}, {3.874258521079904*^9, 
   3.874258540530262*^9}, {3.874258608183166*^9, 3.874258811991767*^9}, {
   3.874258842108512*^9, 3.874258843505228*^9}, {3.874261577139475*^9, 
   3.874262139837501*^9}, {3.874262214626707*^9, 3.874262216606015*^9}, 
   3.8742622662691317`*^9, {3.8742623582284937`*^9, 3.87426235980836*^9}, {
   3.874262409095313*^9, 3.874262720042014*^9}, {3.874262754767531*^9, 
   3.8742628967367687`*^9}, {3.87426305810011*^9, 3.874263131494356*^9}, 
   3.874263371390915*^9, {3.874263446613714*^9, 3.874263447685532*^9}, {
   3.874263641768442*^9, 3.874263920858254*^9}, {3.874263996670706*^9, 
   3.8742640672146*^9}, {3.874264100949676*^9, 3.874264213413897*^9}, {
   3.874264410143567*^9, 3.874264557394579*^9}, {3.874264597597193*^9, 
   3.874264684879334*^9}, {3.87426482904786*^9, 3.874264876989863*^9}, {
   3.874264907342538*^9, 3.874264911783886*^9}, {3.874265016112525*^9, 
   3.8742650539793377`*^9}, {3.874265086659758*^9, 3.874265093342288*^9}, {
   3.874265175249271*^9, 3.874265218847629*^9}, 3.874265282433715*^9, {
   3.874265378378542*^9, 3.874265432492652*^9}, {3.874265521447917*^9, 
   3.874265622430365*^9}, {3.8742656756607447`*^9, 3.874265890741164*^9}, {
   3.8742662836800947`*^9, 3.874266325320763*^9}, {3.874277218945471*^9, 
   3.8742772292605457`*^9}, 3.874277379617785*^9, 3.874277437952012*^9, {
   3.8742779837521963`*^9, 3.874278017195837*^9}, {3.874278185094572*^9, 
   3.874278186319495*^9}, {3.874278244904784*^9, 3.874278323222374*^9}, {
   3.8742787793784323`*^9, 3.8742789363356857`*^9}, {3.874279004963662*^9, 
   3.874279023121397*^9}, {3.874279257845344*^9, 3.874279261752605*^9}, {
   3.874329737826824*^9, 3.874329743874935*^9}, {3.874329804253273*^9, 
   3.874329842554427*^9}, {3.87432992190234*^9, 3.874329928758623*^9}, {
   3.874330788634083*^9, 3.874330795175408*^9}, {3.874330890596485*^9, 
   3.874331004343438*^9}, {3.8743312430161667`*^9, 3.8743312478112288`*^9}, {
   3.874331678517116*^9, 3.874331717694503*^9}, {3.874332007117646*^9, 
   3.874332014745659*^9}, {3.874332063732984*^9, 3.874332081598147*^9}, {
   3.8743321508859*^9, 3.874332153789483*^9}, {3.8743322873679867`*^9, 
   3.87433229060816*^9}, {3.8743323696428556`*^9, 3.874332410602759*^9}, {
   3.874335181557457*^9, 3.874335218295134*^9}, {3.874342243074757*^9, 
   3.874342246822077*^9}, {3.874342283366251*^9, 3.8743422892689333`*^9}, {
   3.8743423918613367`*^9, 3.8743425199623957`*^9}, 3.8743428292073917`*^9, {
   3.874342868671887*^9, 3.874342870709775*^9}, {3.874343143106039*^9, 
   3.874343144824666*^9}, {3.874343188128537*^9, 3.874343190303591*^9}, {
   3.8745245186997633`*^9, 3.874524521194466*^9}, {3.87452474778539*^9, 
   3.8745248646827517`*^9}, {3.874525070902123*^9, 3.8745250914632807`*^9}, {
   3.8745251311253777`*^9, 3.874525143132781*^9}, 3.8745252087138147`*^9, {
   3.874525272362172*^9, 3.874525307098093*^9}, {3.874525361092684*^9, 
   3.874525361883544*^9}, {3.874527646107347*^9, 3.87452767017661*^9}, {
   3.874527793410242*^9, 3.874527794115711*^9}, {3.874527832374545*^9, 
   3.874527850411703*^9}, {3.874527904390173*^9, 3.874527925483728*^9}, {
   3.874528017622229*^9, 3.8745284705019197`*^9}, {3.874528574645256*^9, 
   3.874528576574785*^9}, {3.874528625547515*^9, 3.87452862674393*^9}, {
   3.874528691566505*^9, 3.87452882524727*^9}, {3.874528875165306*^9, 
   3.874528883783835*^9}, 3.875209108991604*^9, 3.8752092259707737`*^9, {
   3.875209301383707*^9, 3.87520930629773*^9}, {3.87520942641817*^9, 
   3.8752094274120398`*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"0c5d3da6-7fc6-4191-b06a-9c3f03730434"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example:", "Section",
 CellChangeTimes->{{3.874525183706406*^9, 
  3.874525188478898*^9}},ExpressionUUID->"dfc91647-eafe-4a6a-be3a-\
6b2eae2e9d49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"gateSet", ",", "errList", ",", "gateList"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"inputs", " ", "as", " ", "matrices"}], ",", " ", 
    RowBox[{
    "make", " ", "sure", " ", "Ei", " ", "are", " ", "not", " ", 
     "exponentiated"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gateList", " ", "=", " ", 
   RowBox[{"Reverse", "[", 
    RowBox[{"{", 
     RowBox[{"G0", ",", "G1", ",", "G2", ",", "G3", ",", "G4", ",", "G5"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"errList", " ", "=", " ", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{
       "E0", ",", " ", "E1", ",", " ", "E2", ",", " ", "E3", ",", "E4", ",", 
        "E5"}], "}"}], "]"}]}], ";"}], ")"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "LeftForm", " ", "creates", " ", "the", " ", "GST", " ", "string", " ", 
     "that", " ", "puts", " ", "the", " ", "error", " ", "after"}], ",", " ", 
    
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "to"}], " ", "the", " ", "left", " ", 
     "of"}], ",", " ", 
    RowBox[{"the", " ", "gate"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"gateSet", " ", "=", " ", 
  RowBox[{"LeftForm", "[", 
   RowBox[{"gateList", ",", "errList"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQXeYstkLg3htHkduf14Hox8sldoDotjU3DoDovNnP
joDoo/NnHAXRD8wrT4HoS01broDopzU8r0D0zf3Gr0E0m9uiPyB6Vfc6MJ0W
aMolCKS/tYfygeicdUnCIPrf1SA5EL1B8okyiF4QPUUbRFcusjQC0W5mnMYg
ukJdwBxEfzmmaQMWz70YAaLXdDGlguiix4YzQPSxahsw/eGhyTwQvagnfjmI
nnankEkISPcvX84KolN+pbIIA+n5u76yguh3XqF1INpmHW89iH5szjwXRPve
EJ0Hoj9PmHsSRJ8zXAWm9xiH7pIF0tecmPaB6EcsKodAtIqY43EQvfaX1FsL
IC1arAGmzT6fSDe//8ax78JjMK0VMV0mAUg7XDwlD6IBQjrJyA==
  
  "],ExpressionUUID->"820a3b62-40d6-4799-aafe-690bca164519"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "G5", ",", "E5", ",", "E4", ",", "G4", ",", "E3", ",", "G3", ",", "E2", ",",
    "G2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], ",", 
       RowBox[{"y", "[", "2", "]"}], ",", 
       RowBox[{"y", "[", "3", "]"}], ",", 
       RowBox[{"y", "[", "4", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "[", "5", "]"}], ",", 
       RowBox[{"y", "[", "6", "]"}], ",", 
       RowBox[{"y", "[", "7", "]"}], ",", 
       RowBox[{"y", "[", "8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "[", "9", "]"}], ",", 
       RowBox[{"y", "[", "10", "]"}], ",", 
       RowBox[{"y", "[", "11", "]"}], ",", 
       RowBox[{"y", "[", "12", "]"}]}], "}"}]}], "}"}], ",", "G1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"x", "[", "2", "]"}], ",", 
       RowBox[{"x", "[", "3", "]"}], ",", 
       RowBox[{"x", "[", "4", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], ",", 
       RowBox[{"x", "[", "6", "]"}], ",", 
       RowBox[{"x", "[", "7", "]"}], ",", 
       RowBox[{"x", "[", "8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "9", "]"}], ",", 
       RowBox[{"x", "[", "10", "]"}], ",", 
       RowBox[{"x", "[", "11", "]"}], ",", 
       RowBox[{"x", "[", "12", "]"}]}], "}"}]}], "}"}], ",", "G0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.87452523900708*^9, 3.8745272805779953`*^9, 3.874528248834086*^9, {
   3.874528391538211*^9, 3.874528497173173*^9}, 3.874528581461256*^9, 
   3.874528628864213*^9, {3.874528811454445*^9, 3.874528846352764*^9}, 
   3.874528891393929*^9, 3.8745491836195793`*^9, 3.8745492371804132`*^9, {
   3.874605272107174*^9, 3.874605275606532*^9}, {3.8751260755948133`*^9, 
   3.875126079989015*^9}, 3.875209445621532*^9},
 CellLabel->
  "Out[369]=",ExpressionUUID->"296e1d6d-1c3b-43a8-a03a-fdfcb525169f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Puts", " ", "the", " ", "input", " ", "GST", " ", "string", " ", "into", 
    " ", "\"\<normal ordering\>\"", " ", "with", " ", "commutation", " ", 
    "relations", " ", "enforced"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sortedGST", " ", "=", 
   RowBox[{"SortLGSTArray", "[", "gateSet", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.874525246443426*^9, 3.87452526018804*^9}, {
  3.8745288565561037`*^9, 3.874528859147732*^9}, {3.8745492415617847`*^9, 
  3.874549259657464*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"91fcc77c-c961-446d-8571-b22827871933"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"G5", ",", "E5", ",", "E4", ",", 
   RowBox[{"G4", ".", "E3", ".", 
    RowBox[{"Inverse", "[", "G4", "]"}]}], ",", 
   RowBox[{"G4", ".", "G3", ".", "E2", ".", 
    RowBox[{"Inverse", "[", "G3", "]"}], ".", 
    RowBox[{"Inverse", "[", "G4", "]"}]}], ",", 
   RowBox[{"G4", ".", "G3", ".", "G2", ".", "E1", ".", 
    RowBox[{"Inverse", "[", "G2", "]"}], ".", 
    RowBox[{"Inverse", "[", "G3", "]"}], ".", 
    RowBox[{"Inverse", "[", "G4", "]"}]}], ",", 
   RowBox[{"G4", ".", "G3", ".", "G2", ".", "G1", ".", "E0", ".", 
    RowBox[{"Inverse", "[", "G1", "]"}], ".", 
    RowBox[{"Inverse", "[", "G2", "]"}], ".", 
    RowBox[{"Inverse", "[", "G3", "]"}], ".", 
    RowBox[{"Inverse", "[", "G4", "]"}]}], ",", "G4", ",", "G3", ",", "G2", 
   ",", "G1", ",", "G0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8745252513181458`*^9, 3.8745272821775618`*^9, {3.874528849869569*^9, 
   3.874528861003911*^9}, 3.874528892696837*^9, 3.874549185708658*^9, 
   3.874605288620891*^9, 3.875126083580243*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"905163d6-9e52-4ad7-aeb8-851a839d6d8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpGSTGates", "[", "sortedGST", "]"}]], "Input",
 CellChangeTimes->{{3.874528863558301*^9, 3.874528867550839*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"c11e1a8e-9342-4625-bb27-018a2645e981"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"G5", ",", 
   RowBox[{"MatrixExp", "[", "E5", "]"}], ",", 
   RowBox[{"MatrixExp", "[", "E4", "]"}], ",", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"G4", ".", "E3", ".", 
     RowBox[{"Inverse", "[", "G4", "]"}]}], "]"}], ",", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"G4", ".", "G3", ".", "E2", ".", 
     RowBox[{"Inverse", "[", "G3", "]"}], ".", 
     RowBox[{"Inverse", "[", "G4", "]"}]}], "]"}], ",", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"G4", ".", "G3", ".", "G2", ".", "E1", ".", 
     RowBox[{"Inverse", "[", "G2", "]"}], ".", 
     RowBox[{"Inverse", "[", "G3", "]"}], ".", 
     RowBox[{"Inverse", "[", "G4", "]"}]}], "]"}], ",", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"G4", ".", "G3", ".", "G2", ".", "G1", ".", "E0", ".", 
     RowBox[{"Inverse", "[", "G1", "]"}], ".", 
     RowBox[{"Inverse", "[", "G2", "]"}], ".", 
     RowBox[{"Inverse", "[", "G3", "]"}], ".", 
     RowBox[{"Inverse", "[", "G4", "]"}]}], "]"}], ",", "G4", ",", "G3", ",", 
   "G2", ",", "G1", ",", "G0"}], "}"}]], "Output",
 CellChangeTimes->{{3.874528867849709*^9, 3.874528894442945*^9}, 
   3.874549187248394*^9, 3.875126085977553*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"1ade422b-09ce-4e4d-805b-35aaa2bbc9f2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.874528852424883*^9, 
  3.8745288544698763`*^9}},ExpressionUUID->"36e5b327-3a70-453c-8300-\
bba633a0648e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["BCH Expansion", "Section",
 CellChangeTimes->{{3.874525411612249*^9, 
  3.8745254139269657`*^9}},ExpressionUUID->"c195c97f-75ca-4588-86bf-\
c86c49ca479b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"G3", ",", "E3", ",", "n", ",", "A"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCH2", "[", "termList_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sumList", "=", 
       RowBox[{"Total", "[", "termList", "]"}]}], "}"}], ",", 
     RowBox[{"1", " ", "+", " ", "sumList", " ", "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"NCExpand", "[", 
        SuperscriptBox[
         RowBox[{"(", "sumList", ")"}], "2"], "]"}]}]}]}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BCH3", "[", "termList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sumList", "=", 
      RowBox[{"Total", "[", "termList", "]"}]}], "}"}], ",", 
    RowBox[{"1", " ", "+", " ", "sumList", " ", "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"NCExpand", "[", 
       SuperscriptBox[
        RowBox[{"(", "sumList", ")"}], "2"], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["1", "6"], 
      RowBox[{"NCExpand", "[", 
       SuperscriptBox[
        RowBox[{"(", "sumList", ")"}], "3"], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.874526452164863*^9, 3.874526519804162*^9}, {
  3.874526550176964*^9, 3.874526690152141*^9}, {3.8745267327829733`*^9, 
  3.8745268136833973`*^9}, {3.874526851532343*^9, 3.874526951124475*^9}, {
  3.874527000963214*^9, 3.8745270489775877`*^9}, {3.8745271396394587`*^9, 
  3.8745272453730927`*^9}, {3.874527304714684*^9, 3.874527521568453*^9}, {
  3.874549446055217*^9, 3.87454945900273*^9}, {3.874549509251506*^9, 
  3.874549582072722*^9}, {3.874549660800865*^9, 3.874549714541834*^9}, {
  3.875209437979191*^9, 3.8752094384932423`*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"6af47c7b-52e3-44d0-8de2-cdd95a7a7718"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"A", ",", "B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termList", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"A", ",", "B", ",", "F", ",", "G"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetNonCommutative", "[", "termList", "]"}], "\[IndentingNewLine]", 
 RowBox[{"BCH3", "[", "termList", "]"}]}], "Input",
 CellChangeTimes->{{3.8745266923739977`*^9, 3.8745267090859423`*^9}, {
   3.874527025250845*^9, 3.874527027189413*^9}, {3.874527413082472*^9, 
   3.874527417280958*^9}, {3.874527468133066*^9, 3.874527473578906*^9}, {
   3.874527524594303*^9, 3.874527544377887*^9}, 3.874527613898819*^9, {
   3.874549325649707*^9, 3.874549334696158*^9}, {3.874549586147407*^9, 
   3.874549586261086*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"d026a865-b892-466a-ac5b-06ac28fb409d"],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"{", 
   RowBox[{"A", ",", "B", ",", "F", ",", "G"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.8751261471325912`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"0339b59b-65bd-4735-b5c6-a0e74aae190d"],

Cell[BoxData[
 RowBox[{"1", "+", "A", "+", "B", "+", "F", "+", "G", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"NCExpand", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"A", "+", "B", "+", "F", "+", "G"}], ")"}], "2"], "]"}]}], "+", 
  
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"NCExpand", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"A", "+", "B", "+", "F", "+", "G"}], ")"}], "3"], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.875126147135*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"0b6efd22-5b3e-4096-b287-d99cf2229102"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Exp2", "[", "FMat", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.874549636011937*^9, 3.8745496556588593`*^9}, {
  3.874549718946279*^9, 3.8745497336948557`*^9}},
 CellLabel->
  "In[1370]:=",ExpressionUUID->"7d090b7e-dde8-418d-96f0-4ff2886fee49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["5", "2"], "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "1", "]"}], "2"], "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "2", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "2", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "3", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "3", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "4", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "4", "]"}], "2"], "2"]}]},
     {
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "5", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "6", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "6", "]"}], "2"], "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "7", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "7", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "8", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "8", "]"}], "2"], "2"]}]},
     {
      RowBox[{
       RowBox[{"x", "[", "9", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "9", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "10", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "10", "]"}], "2"], "2"]}], 
      RowBox[{
       RowBox[{"x", "[", "11", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "11", "]"}], "2"], "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "12", "]"}], "+", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"x", "[", "12", "]"}], "2"], "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.874549644270267*^9, {3.874549728041828*^9, 3.87454973417327*^9}},
 CellLabel->
  "Out[1370]//MatrixForm=",ExpressionUUID->"979460fc-0b32-4081-9b46-\
a16cef95234c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"IdentityMatrix", "[", 
   RowBox[{"4", ",", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.874549678646646*^9, 3.874549692968834*^9}},
 CellLabel->
  "In[1364]:=",ExpressionUUID->"0239ad2d-9346-4216-bba1-c5e113d60c12"],

Cell[BoxData[
 TemplateBox[{
  "IdentityMatrix", "targ", 
   "\"Argument \\!\\(\\*RowBox[{\\\"4\\\"}]\\) at position \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) is not List or SparseArray.\"", 2, 1364, 61, 
   34375523485007757715, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8745496932767467`*^9},
 CellLabel->
  "During evaluation of \
In[1364]:=",ExpressionUUID->"4376904e-90dc-4ec3-a02f-6d1b7898756b"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellChangeTimes->{{3.8745496841425*^9, 3.8745496932907457`*^9}},
 CellLabel->
  "Out[1364]=",ExpressionUUID->"067584bb-3e2e-4b07-8c9f-dd13129ab977"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"OpToPTM", "[", 
    RowBox[{
     RowBox[{"PauliMatrix", "[", "1", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", " ", "=", " ", 
   RowBox[{"OpToPTM", "[", 
    RowBox[{
     RowBox[{"PauliMatrix", "[", "2", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", " ", "=", " ", 
   RowBox[{"OpToPTM", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E0", " ", "=", " ", 
   RowBox[{"FMat", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1", " ", "=", " ", 
   RowBox[{"FMat", "[", "y", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GateSet", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Id", ",", "X", ",", "Z", ",", "Id"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ErrorMaps", " ", "=", 
   RowBox[{"{", 
    RowBox[{"Id", ",", " ", "E0", ",", " ", "E1", ",", " ", "Id"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gstString", " ", "=", 
   RowBox[{"LeftForm", "[", 
    RowBox[{"GateSet", ",", " ", "ErrorMaps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortedGST", " ", "=", " ", 
   RowBox[{"SortLGSTArray", "[", "gstString", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BExpd", " ", "=", " ", 
  RowBox[{"sortedGST", "[", 
   RowBox[{"[", 
    RowBox[{"3", ";;", "4"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87460662647661*^9, 3.874606649005806*^9}, {
  3.8751260945171137`*^9, 3.8751261029947233`*^9}, {3.8751261354928007`*^9, 
  3.8751262626193542`*^9}, {3.875126323923244*^9, 3.8751263427210207`*^9}, {
  3.875126405764124*^9, 3.875126443266768*^9}, {3.875127143818843*^9, 
  3.87512724216842*^9}, {3.875209073915283*^9, 3.8752090904895763`*^9}, {
  3.875209269275543*^9, 3.87520927243111*^9}, {3.875209319345649*^9, 
  3.8752094076775846`*^9}, {3.87520957959741*^9, 3.8752096328256817`*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"d245bb29-df08-45c6-8c4d-32a62b8f20ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"x", "[", "2", "]"}], ",", 
       RowBox[{"x", "[", "3", "]"}], ",", 
       RowBox[{"x", "[", "4", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], ",", 
       RowBox[{"x", "[", "6", "]"}], ",", 
       RowBox[{"x", "[", "7", "]"}], ",", 
       RowBox[{"x", "[", "8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "9", "]"}], ",", 
       RowBox[{"x", "[", "10", "]"}], ",", 
       RowBox[{"x", "[", "11", "]"}], ",", 
       RowBox[{"x", "[", "12", "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "[", "1", "]"}], ",", 
       RowBox[{"y", "[", "2", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"y", "[", "3", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"y", "[", "4", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"y", "[", "5", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"y", "[", "6", "]"}]}], ",", 
       RowBox[{"y", "[", "7", "]"}], ",", 
       RowBox[{"y", "[", "8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"y", "[", "9", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"y", "[", "10", "]"}]}], ",", 
       RowBox[{"y", "[", "11", "]"}], ",", 
       RowBox[{"y", "[", "12", "]"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.87512616388638*^9, 3.875126178777135*^9}, {
   3.875126218306651*^9, 3.875126263060334*^9}, {3.87512641951737*^9, 
   3.875126443720525*^9}, 3.875127155736384*^9, {3.875127225601573*^9, 
   3.8751272426991863`*^9}, {3.8752090818564157`*^9, 3.875209090887648*^9}, {
   3.875209248848013*^9, 3.875209273104507*^9}, {3.875209314639269*^9, 
   3.875209367591934*^9}, {3.875209399595839*^9, 3.8752094086128063`*^9}, 
   3.875209451828079*^9, 3.8752094835592737`*^9, 3.875209580392407*^9, {
   3.875209621387661*^9, 3.875209634671002*^9}},
 CellLabel->
  "Out[453]=",ExpressionUUID->"ac5bf72c-5c09-4e0f-b7ec-2f61c5d765b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OpToPTM", "[", 
   RowBox[{
    RowBox[{"MatrixPower", "[", 
     RowBox[{"X", ",", 
      FractionBox["1", "2"]}], "]"}], ",", "1"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.875126779853948*^9, 3.8751267981099653`*^9}, {
  3.875126897581624*^9, 3.875126903317046*^9}, {3.8751271150723*^9, 
  3.875127121306978*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"5dada365-b644-4d3e-95d6-eda45dabc78a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.875126783231454*^9, 3.8751268214676313`*^9}, {
   3.8751268907587357`*^9, 3.875126903952998*^9}, 3.875126972087631*^9, {
   3.875127109347548*^9, 3.875127121875222*^9}},
 CellLabel->
  "Out[187]//MatrixForm=",ExpressionUUID->"60b6a833-72e6-4fc3-9ecd-\
38fac534063f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PauliTuples", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.875127017841538*^9, 3.875127026335039*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"950e18b3-a65b-47f5-822d-e2ef7e296c39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.875127019731573*^9, 3.875127026751051*^9}},
 CellLabel->
  "Out[170]=",ExpressionUUID->"8cf5c6a2-84d0-4b14-affa-dd81451addfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPauliRepr", "[", 
  RowBox[{"X", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.875127052652137*^9, 3.875127084949359*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"ceb6da6e-e810-4c57-9309-c08aa04381e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.875127056211666*^9, 3.8751271005572567`*^9}},
 CellLabel->
  "Out[185]=",ExpressionUUID->"ae275c2d-d7b2-453d-bff1-93d7dc4b8a7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BExpd", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8752096475137577`*^9, 3.8752096503552723`*^9}},
 CellLabel->
  "In[454]:=",ExpressionUUID->"d9376900-4771-42cf-81d0-66c8632dacfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"x", "[", "2", "]"}], ",", 
     RowBox[{"x", "[", "3", "]"}], ",", 
     RowBox[{"x", "[", "4", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "5", "]"}], ",", 
     RowBox[{"x", "[", "6", "]"}], ",", 
     RowBox[{"x", "[", "7", "]"}], ",", 
     RowBox[{"x", "[", "8", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "9", "]"}], ",", 
     RowBox[{"x", "[", "10", "]"}], ",", 
     RowBox[{"x", "[", "11", "]"}], ",", 
     RowBox[{"x", "[", "12", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.875209650669025*^9},
 CellLabel->
  "Out[454]=",ExpressionUUID->"05d23a39-28bf-44b1-ac8b-47bb850b88ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prod", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp2", "[", 
      RowBox[{"FMat", "[", "x", "]"}], "]"}], "*", 
     RowBox[{"Exp2", "[", 
      RowBox[{"FMat", "[", "y", "]"}], "]"}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"prod", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.87520966757688*^9, 3.8752098129137783`*^9}, {
  3.875210397647751*^9, 3.875210403391918*^9}, {3.875210960823022*^9, 
  3.8752110237824574`*^9}, {3.875211255727252*^9, 3.875211266934072*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"a2f8bcc8-ce9b-46b6-a213-85542d337dc7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"x", "[", "5", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"x", "[", "9", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"y", "[", "5", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"y", "[", "9", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"x", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"x", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"x", "[", "10", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"y", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"y", "[", "10", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"x", "[", "11", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}], "+", 
            RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"y", "[", "11", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"x", "[", "8", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"y", "[", "8", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}], "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1", "]"}], " ", 
          RowBox[{"x", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "5", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "8", "]"}], " ", 
          RowBox[{"x", "[", "9", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], " ", 
          RowBox[{"y", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "5", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "8", "]"}], " ", 
          RowBox[{"y", "[", "9", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "6", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "8", "]"}], " ", 
          RowBox[{"x", "[", "10", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "6", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}], "+", 
            RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "8", "]"}], " ", 
          RowBox[{"y", "[", "10", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"x", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "7", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "8", "]"}], " ", 
          RowBox[{"x", "[", "11", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"y", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "7", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "8", "]"}], " ", 
          RowBox[{"y", "[", "11", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"x", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "8", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "7", "]"}], "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"y", "[", "6", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "8", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}], "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "1", "]"}], " ", 
          RowBox[{"x", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "5", "]"}], " ", 
          RowBox[{"x", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "9", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], " ", 
          RowBox[{"y", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "5", "]"}], " ", 
          RowBox[{"y", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "9", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "6", "]"}], " ", 
          RowBox[{"x", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "10", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "2", "]"}], "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "6", "]"}], " ", 
          RowBox[{"y", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "10", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "2", "]"}], "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "3", "]"}], " ", 
          RowBox[{"x", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "11", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "7", "]"}], "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "3", "]"}], " ", 
          RowBox[{"y", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "11", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}], "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"x", "[", "4", "]"}], " ", 
          RowBox[{"x", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "8", "]"}], " ", 
          RowBox[{"x", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "12", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"y", "[", "4", "]"}], " ", 
          RowBox[{"y", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "8", "]"}], " ", 
          RowBox[{"y", "[", "11", "]"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "12", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.875209688058525*^9, 3.87520982440231*^9}, {
   3.87521039954468*^9, 3.875210403618019*^9}, {3.87521099018202*^9, 
   3.875211024509305*^9}, 3.8752110580034037`*^9, 3.87521126846189*^9},
 CellLabel->
  "Out[488]//MatrixForm=",ExpressionUUID->"65ddabc4-7596-47f8-b9cd-\
4831e70403aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", " ", "=", " ", 
   RowBox[{
    RowBox[{"Exp2", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FMat", "[", "x", "]"}], "+", 
        RowBox[{"FMat", "[", "y", "]"}]}], ")"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FMat", "[", "x", "]"}], "*", 
          RowBox[{"FMat", "[", "y", "]"}]}], "+", 
         RowBox[{
          RowBox[{"FMat", "[", "y", "]"}], "*", 
          RowBox[{"FMat", "[", "x", "]"}]}]}], ")"}]}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sum", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.875211003525895*^9, 3.8752110055003443`*^9}, {
  3.875211061053232*^9, 3.875211062574173*^9}, {3.875211230222748*^9, 
  3.875211231131072*^9}, {3.875211272697825*^9, 3.875211280834197*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"fbdded5f-9896-4a65-8989-0c28d3be2e45"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "+", 
       RowBox[{"y", "[", "1", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "1", "]"}], " ", 
        RowBox[{"y", "[", "1", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "1", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "3", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "3", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "5", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "5", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "4", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "4", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "9", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "9", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "2", "]"}], "+", 
       RowBox[{"y", "[", "2", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "2", "]"}], " ", 
        RowBox[{"y", "[", "2", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}]}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "3", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "3", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "6", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "6", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "4", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "4", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "10", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "10", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"x", "[", "3", "]"}], "+", 
       RowBox[{"y", "[", "3", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "3", "]"}], " ", 
        RowBox[{"y", "[", "3", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "3", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "3", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
             RowBox[{"y", "[", "7", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "7", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "4", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "4", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "11", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "11", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"x", "[", "4", "]"}], "+", 
       RowBox[{"y", "[", "4", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "4", "]"}], " ", 
        RowBox[{"y", "[", "4", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "3", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "3", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "8", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "8", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "4", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "4", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
             RowBox[{"y", "[", "12", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "12", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], "+", 
       RowBox[{"y", "[", "5", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "5", "]"}], " ", 
        RowBox[{"y", "[", "5", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "1", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "6", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "6", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "5", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "5", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "7", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "7", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "8", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "8", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "9", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "9", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"x", "[", "6", "]"}], "+", 
       RowBox[{"y", "[", "6", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "6", "]"}], " ", 
        RowBox[{"y", "[", "6", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "6", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "6", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
             RowBox[{"y", "[", "7", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "7", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "8", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "8", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "10", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "10", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "7", "]"}], "+", 
       RowBox[{"y", "[", "7", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "7", "]"}], " ", 
        RowBox[{"y", "[", "7", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "3", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "3", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "6", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "6", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "7", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "7", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "8", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "8", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "11", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "11", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "4", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "6", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "6", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "8", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "7", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
            RowBox[{"y", "[", "12", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "12", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"x", "[", "9", "]"}], "+", 
       RowBox[{"y", "[", "9", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "9", "]"}], " ", 
        RowBox[{"y", "[", "9", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "1", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "10", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "10", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "5", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "5", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "11", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "11", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "9", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "9", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "12", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "12", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"x", "[", "10", "]"}], "+", 
       RowBox[{"y", "[", "10", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "10", "]"}], " ", 
        RowBox[{"y", "[", "10", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "6", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "6", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "11", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "11", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "10", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "10", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "2", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
             RowBox[{"y", "[", "12", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "12", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "3", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "10", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "10", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "11", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "11", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"y", "[", "7", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "7", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
            RowBox[{"y", "[", "12", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "12", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"x", "[", "12", "]"}], "+", 
       RowBox[{"y", "[", "12", "]"}], "+", 
       RowBox[{
        RowBox[{"x", "[", "12", "]"}], " ", 
        RowBox[{"y", "[", "12", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "4", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "4", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "10", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "10", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "8", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "8", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "11", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "11", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "12", "]"}], "+", 
             RowBox[{
              RowBox[{"x", "[", "12", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}], "2"]}], 
         ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.875211002313271*^9, 3.875211006177267*^9}, 
   3.875211065448719*^9, 3.875211236785149*^9, 3.8752112815058804`*^9},
 CellLabel->
  "Out[490]//MatrixForm=",ExpressionUUID->"350a2231-fff6-4f30-9b98-\
81558248d9d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"prod", "-", "sum"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8752112889114637`*^9, 3.875211291880987*^9}},
 CellLabel->
  "In[491]:=",ExpressionUUID->"0b87354e-c278-46b6-aaf6-d3b9cc45cb40"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "1", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "1", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "1", "]"}], " ", 
         RowBox[{"y", "[", "1", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "5", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"x", "[", "5", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"x", "[", "9", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"y", "[", "5", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"y", "[", "9", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "9", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "2", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "2", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "2", "]"}], " ", 
         RowBox[{"y", "[", "2", "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "2", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "2", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "2", "]"}]}], ")"}]}]}], ")"}], "2"]}], "-", 
        
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"x", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"x", "[", "10", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"y", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"y", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"y", "[", "10", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "3", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "3", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "3", "]"}], " ", 
         RowBox[{"y", "[", "3", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "7", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}], "+", 
              RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"x", "[", "11", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}], "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"y", "[", "11", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "4", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "4", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "4", "]"}], " ", 
         RowBox[{"y", "[", "4", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "12", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"x", "[", "8", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}], "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"y", "[", "8", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}], "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "5", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "5", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "5", "]"}], " ", 
         RowBox[{"y", "[", "5", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "5", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "7", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"x", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"x", "[", "9", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], " ", 
            RowBox[{"y", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], " ", 
            RowBox[{"y", "[", "9", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "9", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "6", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "6", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "6", "]"}], " ", 
         RowBox[{"y", "[", "6", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "7", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}], "+", 
              RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"x", "[", "10", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}], "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], " ", 
            RowBox[{"y", "[", "10", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "7", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "7", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "7", "]"}], " ", 
         RowBox[{"y", "[", "7", "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "7", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "7", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "7", "]"}]}], ")"}]}]}], ")"}], "2"]}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"x", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"x", "[", "11", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"y", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], " ", 
            RowBox[{"y", "[", "11", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"y", "[", "7", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "12", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"x", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "7", "]"}], "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"y", "[", "6", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "7", "]"}], "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "9", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "9", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "9", "]"}], " ", 
         RowBox[{"y", "[", "9", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "1", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "5", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "5", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "9", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "9", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "12", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], " ", 
            RowBox[{"x", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "5", "]"}], " ", 
            RowBox[{"x", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], " ", 
            RowBox[{"y", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "5", "]"}], " ", 
            RowBox[{"y", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"x", "[", "10", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "10", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "10", "]"}], " ", 
         RowBox[{"y", "[", "10", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "6", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "6", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "2", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "12", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "6", "]"}], " ", 
            RowBox[{"x", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "2", "]"}], "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "6", "]"}], " ", 
            RowBox[{"y", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "2", "]"}], "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "3", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "3", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"y", "[", "7", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "7", "]"}]}], ")"}]}], "+", 
           RowBox[{"y", "[", "12", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "3", "]"}], " ", 
            RowBox[{"x", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "7", "]"}], "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "3", "]"}], " ", 
            RowBox[{"y", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "7", "]"}], "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "12", "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "4", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "10", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "10", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "10", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "8", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "8", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", "[", "11", "]"}], "+", 
           RowBox[{
            RowBox[{"x", "[", "11", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"y", "[", "11", "]"}]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"y", "[", "12", "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"x", "[", "12", "]"}], " ", 
         RowBox[{"y", "[", "12", "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", "[", "12", "]"}], "+", 
            RowBox[{
             RowBox[{"x", "[", "12", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"x", "[", "4", "]"}], " ", 
            RowBox[{"x", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "8", "]"}], " ", 
            RowBox[{"x", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"x", "[", "12", "]"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"y", "[", "4", "]"}], " ", 
            RowBox[{"y", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "8", "]"}], " ", 
            RowBox[{"y", "[", "11", "]"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "12", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"y", "[", "12", "]"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.875211300633813*^9},
 CellLabel->
  "Out[491]=",ExpressionUUID->"d5c8e1a6-b373-4aa1-ae32-1215deccdf93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "**", " ", "Y"}], "-", 
  RowBox[{"Y", " ", "**", " ", "X"}]}]}], "Input",
 CellChangeTimes->{{3.875211781705521*^9, 3.875211800714327*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"a2f4862c-0d91-4760-a1c2-335d7fd5cd57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "**", "Y"}], "-", 
  RowBox[{"Y", "**", "X"}]}]], "Output",
 CellChangeTimes->{{3.875211783799191*^9, 3.8752118009482183`*^9}},
 CellLabel->
  "Out[500]=",ExpressionUUID->"780e91bd-b6e6-43ce-9721-f5b1fc7687ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.875212012182086*^9, 
  3.875212080608369*^9}},ExpressionUUID->"b345b70d-f63e-4f71-9091-\
c0fc603965f4"],

Cell[BoxData[
 RowBox[{"NCExpand", "[", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"X", "+", "Y", "+", 
     FractionBox[
      RowBox[{"X", "**", "Y"}], "2"], "-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}], "2"], "]"}]], "Output",
 CellChangeTimes->{{3.875212037666005*^9, 3.875212077704506*^9}},
 CellLabel->
  "Out[517]=",ExpressionUUID->"737991bd-3d61-42ee-bafe-e8b4e961733c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "NC`"}]], "Input",
 CellChangeTimes->{{3.875212060143598*^9, 3.875212064734714*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"0a66066c-6f24-4782-8d35-1d757ebfa96f"],

Cell[BoxData[
 TemplateBox[{
  "NC", "Directory", 
   "\"You are using the version of NCAlgebra which is found in: \
\\\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/home/kharazi/NC/\\\\\\\"\\\"}]\\)\\\".\"", 
   2, 514, 38, 34380376628354824473, "Local", "NC`NC"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.8752120651702337`*^9},
 CellLabel->
  "During evaluation of \
In[514]:=",ExpressionUUID->"e7fab889-041f-49a1-8471-e0f25bd0bf6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term", " ", "=", 
  RowBox[{"(", 
   RowBox[{"X", "+", "Y", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"X", "**", "Y"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Y", "**", "X"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.875212083935248*^9, 3.875212110848762*^9}, {
  3.8752121477135887`*^9, 3.875212158459364*^9}, {3.875212200507205*^9, 
  3.875212218108077*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"465fe65b-0307-48dd-94fe-d6d080698599"],

Cell[BoxData[
 RowBox[{"X", "+", "Y", "+", 
  FractionBox[
   RowBox[{"X", "**", "Y"}], "2"], "-", 
  FractionBox[
   RowBox[{"Y", "**", "X"}], "2"]}]], "Output",
 CellChangeTimes->{{3.8752120815452757`*^9, 3.875212111652828*^9}, 
   3.8752122234784317`*^9},
 CellLabel->
  "Out[521]=",ExpressionUUID->"e6b0c03a-25a1-4867-8f3a-3643e4ed454c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{"term", ",", "term"}], "]"}], "//", "Distribute"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.875212205775918*^9, 3.875212249504561*^9}, {
  3.875212304518879*^9, 3.875212314379353*^9}},
 CellLabel->
  "In[527]:=",ExpressionUUID->"88fb7a1c-2af1-4df8-8230-139e4e6985b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "**", "X"}], "+", 
  RowBox[{"X", "**", "Y"}], "+", 
  RowBox[{"X", "**", 
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"]}], "+", 
  RowBox[{"X", "**", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}]}], "+", 
  RowBox[{"Y", "**", "X"}], "+", 
  RowBox[{"Y", "**", "Y"}], "+", 
  RowBox[{"Y", "**", 
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"]}], "+", 
  RowBox[{"Y", "**", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"], "**", "X"}], "+", 
  RowBox[{
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"], "**", "Y"}], "+", 
  RowBox[{
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"], "**", 
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"]}], "+", 
  RowBox[{
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"], "**", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}], "**", "X"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}], "**", "Y"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}], "**", 
   FractionBox[
    RowBox[{"X", "**", "Y"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}], "**", 
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Y", "**", "X"}], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.875212314870554*^9},
 CellLabel->
  "Out[527]=",ExpressionUUID->"143cb22d-e284-44c3-970f-a148f71a4a02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CloudShare", "[", 
  RowBox[{"\"\<cnammour@berkeley.edu\>\"", ","}], "]"}]], "Input",
 CellChangeTimes->{{3.8752129446798267`*^9, 3.875212963870441*^9}, {
  3.87521306050443*^9, 3.8752131554000463`*^9}, {3.8752132113124113`*^9, 
  3.875213238852145*^9}},ExpressionUUID->"b87b468d-c021-4ac7-8e4c-\
8a53590f63be"],

Cell[BoxData[
 TemplateBox[{
  "CloudShare", "invcloudobj", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"cnammour@berkeley.edu\\\\\\\"\\\"}]\\) is \
not a valid cloud object.\"", 2, 533, 42, 34380376628354824473, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.875213219598364*^9},
 CellLabel->
  "During evaluation of \
In[533]:=",ExpressionUUID->"0a859acd-a480-41f9-bdb5-de50d333cfb2"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.875213016853427*^9, {3.875213143403141*^9, 3.8752131573474493`*^9}, 
   3.8752132196121073`*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"d3dc95b3-8403-453f-8492-81ef9fe34db7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{
   "CloudObject", "[", 
    "\"\<https://www.wolframcloud.com/obj/583c31b5-cc25-4570-bc74-\
8581cffe6257\>\"", "]"}], ",", 
   RowBox[{"Permissions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Authenticated\>\"", "\[Rule]", "Automatic"}], "}"}]}]}], 
  "]"}]], "Input",
 NumberMarks->False,
 CellLabel->
  "In[532]:=",ExpressionUUID->"3923510f-c27f-48ef-b719-744692027323"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Permissions", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"\<\"Authenticated\"\>", "\[Rule]", "Automatic"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.875213170423244*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"c8f8dcdd-096c-4f7e-985d-e03a25b45277"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9962bcbb-98a3-4193-9eb4-0d75b563e866"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 68, "Section",ExpressionUUID->"c8048c5d-c1a0-4e37-b919-7465432404cf"],
Cell[749, 27, 6223, 151, 418, "Input",ExpressionUUID->"0b3fd763-2d43-455e-86ae-f36af1e1e56e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7009, 183, 163, 3, 68, "Section",ExpressionUUID->"06d0dfdb-889e-4d5e-937d-642bc51d30b5"],
Cell[CellGroupData[{
Cell[7197, 190, 5154, 137, 381, "Input",ExpressionUUID->"e8a42345-a61c-426a-9d13-c6bf73ae057b"],
Cell[12354, 329, 1039, 26, 95, "Output",ExpressionUUID->"1254d911-7a1c-491e-98bb-a5566bc692a8"],
Cell[13396, 357, 1051, 26, 95, "Output",ExpressionUUID->"33afd04b-ee61-44dd-815a-55e013dd540a"],
Cell[14450, 385, 1213, 30, 33, "Output",ExpressionUUID->"558f73b7-9d2c-4984-a619-6a2946f87c2e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15712, 421, 327, 6, 68, "Section",ExpressionUUID->"22a70cee-fa43-4288-bcb1-6178c2273a9d"],
Cell[16042, 429, 547, 15, 44, "Input",ExpressionUUID->"f84eafaa-2273-4382-ae20-f92bab833e23"],
Cell[16592, 446, 16746, 382, 711, "Input",ExpressionUUID->"0c5d3da6-7fc6-4191-b06a-9c3f03730434"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33375, 833, 153, 3, 68, "Section",ExpressionUUID->"dfc91647-eafe-4a6a-be3a-6b2eae2e9d49"],
Cell[CellGroupData[{
Cell[33553, 840, 1920, 48, 133, "Input",ExpressionUUID->"820a3b62-40d6-4799-aafe-690bca164519"],
Cell[35476, 890, 2228, 58, 55, "Output",ExpressionUUID->"296e1d6d-1c3b-43a8-a03a-fdfcb525169f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37741, 953, 618, 12, 51, "Input",ExpressionUUID->"91fcc77c-c961-446d-8571-b22827871933"],
Cell[38362, 967, 1117, 22, 55, "Output",ExpressionUUID->"905163d6-9e52-4ad7-aeb8-851a839d6d8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39516, 994, 217, 3, 29, "Input",ExpressionUUID->"c11e1a8e-9342-4625-bb27-018a2645e981"],
Cell[39736, 999, 1254, 26, 55, "Output",ExpressionUUID->"1ade422b-09ce-4e4d-805b-35aaa2bbc9f2"]
}, Open  ]],
Cell[41005, 1028, 154, 3, 29, "Input",ExpressionUUID->"36e5b327-3a70-453c-8300-bba633a0648e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41196, 1036, 160, 3, 68, "Section",ExpressionUUID->"c195c97f-75ca-4588-86bf-c86c49ca479b"],
Cell[41359, 1041, 1879, 45, 102, "Input",ExpressionUUID->"6af47c7b-52e3-44d0-8de2-cdd95a7a7718"],
Cell[CellGroupData[{
Cell[43263, 1090, 850, 16, 92, "Input",ExpressionUUID->"d026a865-b892-466a-ac5b-06ac28fb409d"],
Cell[44116, 1108, 261, 5, 33, "Output",ExpressionUUID->"0339b59b-65bd-4735-b5c6-a0e74aae190d"],
Cell[44380, 1115, 586, 17, 48, "Output",ExpressionUUID->"0b6efd22-5b3e-4096-b287-d99cf2229102"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45003, 1137, 296, 6, 29, "Input",ExpressionUUID->"7d090b7e-dde8-418d-96f0-4ff2886fee49"],
Cell[45302, 1145, 2617, 83, 139, "Output",ExpressionUUID->"979460fc-0b32-4081-9b46-a16cef95234c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47956, 1233, 278, 6, 29, "Input",ExpressionUUID->"0239ad2d-9346-4216-bba1-c5e113d60c12"],
Cell[48237, 1241, 423, 10, 28, "Message",ExpressionUUID->"4376904e-90dc-4ec3-a02f-6d1b7898756b"],
Cell[48663, 1253, 200, 4, 33, "Output",ExpressionUUID->"067584bb-3e2e-4b07-8c9f-dd13129ab977"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48900, 1262, 2210, 57, 236, "Input",ExpressionUUID->"d245bb29-df08-45c6-8c4d-32a62b8f20ff"],
Cell[51113, 1321, 2376, 62, 55, "Output",ExpressionUUID->"ac5bf72c-5c09-4e0f-b7ec-2f61c5d765b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53526, 1388, 458, 12, 44, "Input",ExpressionUUID->"5dada365-b644-4d3e-95d6-eda45dabc78a"],
Cell[53987, 1402, 867, 24, 95, "Output",ExpressionUUID->"60b6a833-72e6-4fc3-9ecd-38fac534063f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54891, 1431, 213, 4, 29, "Input",ExpressionUUID->"950e18b3-a65b-47f5-822d-e2ef7e296c39"],
Cell[55107, 1437, 338, 9, 33, "Output",ExpressionUUID->"8cf5c6a2-84d0-4b14-affa-dd81451addfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55482, 1451, 238, 5, 29, "Input",ExpressionUUID->"ceb6da6e-e810-4c57-9309-c08aa04381e3"],
Cell[55723, 1458, 248, 6, 33, "Output",ExpressionUUID->"ae275c2d-d7b2-453d-bff1-93d7dc4b8a7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56008, 1469, 234, 5, 29, "Input",ExpressionUUID->"d9376900-4771-42cf-81d0-66c8632dacfe"],
Cell[56245, 1476, 869, 25, 33, "Output",ExpressionUUID->"05d23a39-28bf-44b1-ac8b-47bb850b88ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57151, 1506, 638, 15, 51, "Input",ExpressionUUID->"a2f8bcc8-ce9b-46b6-a213-85542d337dc7"],
Cell[57792, 1523, 11459, 335, 119, "Output",ExpressionUUID->"65ddabc4-7596-47f8-b9cd-4831e70403aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69288, 1863, 988, 26, 66, "Input",ExpressionUUID->"fbdded5f-9896-4a65-8989-0c28d3be2e45"],
Cell[70279, 1891, 23429, 662, 119, "Output",ExpressionUUID->"350a2231-fff6-4f30-9b98-81558248d9d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93745, 2558, 240, 5, 29, "Input",ExpressionUUID->"0b87354e-c278-46b6-aaf6-d3b9cc45cb40"],
Cell[93988, 2565, 34223, 982, 1347, "Output",ExpressionUUID->"d5c8e1a6-b373-4aa1-ae32-1215deccdf93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128248, 3552, 327, 7, 51, "Input",ExpressionUUID->"a2f4862c-0d91-4760-a1c2-335d7fd5cd57"],
Cell[128578, 3561, 249, 6, 33, "Output",ExpressionUUID->"780e91bd-b6e6-43ce-9721-f5b1fc7687ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128864, 3572, 152, 3, 29, "Input",ExpressionUUID->"b345b70d-f63e-4f71-9091-c0fc603965f4"],
Cell[129019, 3577, 408, 11, 48, "Output",ExpressionUUID->"737991bd-3d61-42ee-bafe-e8b4e961733c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129464, 3593, 196, 4, 29, "Input",ExpressionUUID->"0a66066c-6f24-4782-8d35-1d757ebfa96f"],
Cell[129663, 3599, 442, 10, 28, "Message",ExpressionUUID->"e7fab889-041f-49a1-8471-e0f25bd0bf6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130142, 3614, 515, 14, 44, "Input",ExpressionUUID->"465fe65b-0307-48dd-94fe-d6d080698599"],
Cell[130660, 3630, 341, 9, 48, "Output",ExpressionUUID->"e6b0c03a-25a1-4867-8f3a-3643e4ed454c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131038, 3644, 376, 9, 29, "Input",ExpressionUUID->"88fb7a1c-2af1-4df8-8230-139e4e6985b8"],
Cell[131417, 3655, 1851, 68, 121, "Output",ExpressionUUID->"143cb22d-e284-44c3-970f-a148f71a4a02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133305, 3728, 335, 6, 29, "Input",ExpressionUUID->"b87b468d-c021-4ac7-8e4c-8a53590f63be"],
Cell[133643, 3736, 402, 9, 28, "Message",ExpressionUUID->"0a859acd-a480-41f9-bdb5-de50d333cfb2"],
Cell[134048, 3747, 238, 5, 33, "Output",ExpressionUUID->"d3dc95b3-8403-453f-8492-81ef9fe34db7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134323, 3757, 444, 13, 92, "Input",ExpressionUUID->"3923510f-c27f-48ef-b719-744692027323"],
Cell[134770, 3772, 300, 8, 33, "Output",ExpressionUUID->"c8f8dcdd-096c-4f7e-985d-e03a25b45277"]
}, Open  ]]
}, Open  ]]
}
]
*)

